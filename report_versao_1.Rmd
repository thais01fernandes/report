---
title: ""
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document: default
date: ""
---

```{r setup, include=FALSE}

(knitr::opts_chunk$set(
	echo = FALSE,
	error = FALSE,
	message = FALSE,
	warning = FALSE
)
) 
```


```{css Estilo do Relatório}


@import url('https://fonts.googleapis.com/css2?family=Lora:wght@500&display=swap');

h1.title{ 
    font-family: 'Lora', serif;
    color: black;
    font-size: 30px;
    text-align: center;
    font-weight: bold;
}
h4.author{ 
    font-family: 'Lora', serif;
    color: black;
    font-size: 20px;
    text-align: center;
}

h4.date{ 
    font-family: 'Lora', serif;
    color: black;
    font-size: 12px;
    text-align: center;
}

p{
  font-family: 'Lora', serif;
  text-align: justify;
  font-size: 16px
}
h2 {
  font-family: 'Lora', serif;
  font-size: 16px;
  text-align: justify;
}


```


```{r include=FALSE}

library("tidyverse")
library("readxl")
library('googlesheets4')
library("janitor")
library ("abjData")
library("geobr")
library("dplyr")
library("tidyr")
library("purrr")
library("reactable")

```




```{r include=FALSE}

dados_respondentes <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1Zydeu1lZf6rzGeZ3byB_I23TFw9FPqZHn3yYI0LIP_E/edit#gid=0", sheet = 3) %>% 
  janitor::clean_names()


dados_completos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1Zydeu1lZf6rzGeZ3byB_I23TFw9FPqZHn3yYI0LIP_E/edit#gid=0", sheet = 2) 


```


**Estatística Descritiva**

**1. Caracterização da Amostra**

Tabela 1 - Porcentagem de participantes por serviço


```{r echo=FALSE, align = 'center'}

tabela_area <- dados_respondentes %>% 
  group_by(area) %>% 
  tally() %>% 
  mutate(area = replace_na(area, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n)


total_n <- sum(tabela_area$n)
total_pct <- 1


linha_total <- tibble(
  area = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_1 <- bind_rows(tabela_area, linha_total) 

row_style <- function(index) {
  if (index == nrow(tabela_completa_1)) {
    list(
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_1 %>% 
  reactable(
    outlined = FALSE, 
    fullWidth = FALSE,
    bordered = TRUE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      align = "center"
    ),
    columns = list(
      area = colDef(name = "Serviço", minWidth = 350),
      n = colDef(name = "Quantidade", minWidth = 150), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150)
    ), rowStyle = row_style
  )

```


Tabela 2 - Porcentagem de participantes por profissão



```{r echo=FALSE}

tabela_cargo <- dados_respondentes %>% 
  group_by(cargo) %>% 
  tally() %>% 
  mutate(cargo = replace_na(cargo, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n)


total_n <- sum(tabela_cargo$n)
total_pct <- 1


linha_total <- tibble(
  cargo = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_2 <- bind_rows(tabela_cargo, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_2)) {
    list(
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_2 %>% 
  reactable(
    outlined = FALSE, 
    fullWidth = FALSE,
    bordered = TRUE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      align = "center"
    ),
    columns = list(
      cargo = colDef(name = "Serviço", minWidth = 350),
      n = colDef(name = "Quantidade", minWidth = 150), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150)
    ), rowStyle = row_style
  )

```


Tabela 3 - Tempo trabalhado neste hospital



```{r}

tabela_temp_hospital <- dados_respondentes %>% 
  group_by(ha_quanto_tempo_voce_trabalha_neste_hospital) %>% 
  tally() %>% 
  mutate(ha_quanto_tempo_voce_trabalha_neste_hospital = replace_na(ha_quanto_tempo_voce_trabalha_neste_hospital, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Tempo = ha_quanto_tempo_voce_trabalha_neste_hospital)


total_n <- sum(tabela_temp_hospital$n)
total_pct <- 1


linha_total <- tibble(
  Tempo = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_3 <- bind_rows(tabela_temp_hospital, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_3)) {
    list(
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_3 %>% 
  reactable(
    outlined = FALSE, 
    fullWidth = FALSE,
    bordered = TRUE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      align = "center"
    ),
    columns = list(
      Tempo = colDef(name = "Tempo", minWidth = 300),
      n = colDef(name = "Quantidade", minWidth = 150), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150)
    ), rowStyle = row_style
  )


```


Tabela 4 - Tempo trabalhado na área/unidade atual



```{r}

tabela_temp_funcao <- dados_respondentes %>% 
  group_by(neste_hospital_ha_quanto_tempo_voce_trabalha_na_sua_atual_unidade_area_de_trabalho) %>% 
  tally() %>% 
  mutate(neste_hospital_ha_quanto_tempo_voce_trabalha_na_sua_atual_unidade_area_de_trabalho = replace_na(neste_hospital_ha_quanto_tempo_voce_trabalha_na_sua_atual_unidade_area_de_trabalho, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Tempo = neste_hospital_ha_quanto_tempo_voce_trabalha_na_sua_atual_unidade_area_de_trabalho)


total_n <- sum(tabela_temp_funcao$n)
total_pct <- 1


linha_total <- tibble(
  Tempo = "Total",
  n = total_n,
  pct = total_pct
)


tabela_completa_4 <- bind_rows(tabela_temp_funcao, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_4)) {
    list(
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_4 %>% 
  reactable(
    outlined = FALSE, 
    fullWidth = FALSE,
    bordered = TRUE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      align = "center"
    ),
    columns = list(
      Tempo = colDef(name = "Tempo", minWidth = 300),
      n = colDef(name = "Quantidade", minWidth = 150), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150)
    ), rowStyle = row_style
  )



```

Tabela 5 - Quantidade de horas trabalhadas por semana


```{r}


tabela_horas_trabalho <- dados_respondentes %>% 
  group_by(	
normalmente_quantas_horas_por_semana_voce_trabalha_neste_hospital) %>% 
  tally() %>% 
  mutate(	
normalmente_quantas_horas_por_semana_voce_trabalha_neste_hospital = replace_na(normalmente_quantas_horas_por_semana_voce_trabalha_neste_hospital, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Tempo = 	
normalmente_quantas_horas_por_semana_voce_trabalha_neste_hospital)


total_n <- sum(tabela_horas_trabalho$n)
total_pct <- 1


linha_total <- tibble(
  Tempo = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_5 <- bind_rows(tabela_horas_trabalho, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_5)) {
    list(
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_5 %>% 
  reactable(
    outlined = FALSE, 
    fullWidth = FALSE,
    bordered = TRUE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      align = "center"
    ),
    columns = list(
      Tempo = colDef(name = "Tempo", minWidth = 300),
      n = colDef(name = "Quantidade", minWidth = 150), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150)
    ), rowStyle = row_style
  )



```



Tabela 6 - Interação ou contato direto com os pacientes



```{r}


tabela_contato <- dados_respondentes %>% 
  group_by(no_seu_cargo_funcao_em_geral_voce_tem_interacao_ou_contato_direto_com_os_pacientes) %>% 
  tally() %>% 
  mutate(no_seu_cargo_funcao_em_geral_voce_tem_interacao_ou_contato_direto_com_os_pacientes = replace_na(	
no_seu_cargo_funcao_em_geral_voce_tem_interacao_ou_contato_direto_com_os_pacientes, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Contato = 	no_seu_cargo_funcao_em_geral_voce_tem_interacao_ou_contato_direto_com_os_pacientes)


total_n <- sum(tabela_contato$n)
total_pct <- 1


linha_total <- tibble(
  Contato = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_6 <- bind_rows(tabela_contato, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_6)) {
    list(
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_6 %>% 
  reactable(
    outlined = FALSE, 
    fullWidth = FALSE,
    bordered = TRUE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      align = "center"
    ),
    columns = list(
      Contato = colDef(name = "Contato", minWidth = 500),
      n = colDef(name = "Quantidade", minWidth = 150), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150)
    ), rowStyle = row_style
  )



```

**2. Cultura de Segurança do Paciente: Indicadores do HSOPSC**


Tabela 8 - Quantidade de eventos adversos notificados


```{r}

tabela_eventos <- dados_respondentes %>% 
  group_by(nos_ultimos_doze_meses_quantos_incidentes_relacionados_a_seguranca_do_paciente_voce_notificou) %>% 
  tally() %>% 
  mutate(nos_ultimos_doze_meses_quantos_incidentes_relacionados_a_seguranca_do_paciente_voce_notificou = replace_na(	
nos_ultimos_doze_meses_quantos_incidentes_relacionados_a_seguranca_do_paciente_voce_notificou, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Eventos = 	nos_ultimos_doze_meses_quantos_incidentes_relacionados_a_seguranca_do_paciente_voce_notificou)


total_n <- sum(tabela_eventos$n)
total_pct <- 1


linha_total <- tibble(
  Eventos = "Total",
  n = total_n,
  pct = total_pct
)


tabela_completa_7 <- bind_rows(tabela_eventos, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_7)) {
    list(
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_7 %>% 
  reactable(
    outlined = FALSE, 
    fullWidth = FALSE,
    bordered = TRUE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      align = "center"
    ),
    columns = list(
      Eventos = colDef(name = "Eventos", minWidth = 200),
      n = colDef(name = "Quantidade", minWidth = 150), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150)
    ), rowStyle = row_style
  )


```


Tabela 9 - Percepção da segurança do paciente no ambiente de trabalho

```{r}


tabela_avaliacao <- dados_respondentes %>% 
  group_by(avaliacao) %>% 
  tally() %>% 
  mutate(avaliacao = replace_na(	
avaliacao, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Nota = 	avaliacao)


total_n <- sum(tabela_avaliacao$n)
total_pct <- 1


linha_total <- tibble(
  Nota = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_8 <- bind_rows(tabela_avaliacao, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_8)) {
    list(
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_8  %>% 
  reactable(
    outlined = FALSE, 
    fullWidth = FALSE,
    bordered = TRUE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      align = "center"
    ),
    columns = list(
      Nota = colDef(name = "Nota", minWidth = 200),
      n = colDef(name = "Quantidade", minWidth = 150), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150)
    ), rowStyle = row_style
  )


```


Tabela 10 - Porcentagem de respostas por dimensão


```{r eval=FALSE, include=FALSE}

primeira_dimensao <- dados_completos %>% 
  rename(pergunta_1 = meu_supervisor_gerente_ou_chefe_de_equipe_clinica_considera_seriamente_as_sugestoes_dos_profissionais_para_melhorar_a_seguranca_do_paciente, 
         pergunta_2 =  meu_supervisor_gerente_ou_chefe_de_equipe_clinica_quer_que_trabalhemos_mais_rapido_nos_horarios_de_demanda_intensa_de_trabalho_mesmo_que_isso_implique_em_pular_etapas, 
         pergunta_3 = meu_supervisor_gerente_ou_chefe_de_equipe_clinica_adota_medidas_para_resolver_as_questoes_de_seguranca_do_paciente_que_lhe_sao_apresentadas) %>% 
  select(pergunta_1, pergunta_2,  pergunta_3) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Negativo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Positivo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
  mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Positivo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Negativo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "1 - Apoio da gerência do hospital para a segurança do paciente", value))
  




```



































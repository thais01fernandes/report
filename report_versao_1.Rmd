---
title: ""
output:
  html_document:
    df_print: paged
  word_document: default
  pdf_document: default
date: ""
---

```{r setup, include=FALSE}

(knitr::opts_chunk$set(
	echo = FALSE,
	error = FALSE,
	message = FALSE,
	warning = FALSE
)
) 
```


```{css Estilo do Relatório}


@import url('https://fonts.googleapis.com/css2?family=Lora:wght@500&display=swap');

h1.title{ 
    font-family: 'Lora', serif;
    color: black;
    font-size: 30px;
    text-align: center;
    font-weight: bold;
}
h4.author{ 
    font-family: 'Lora', serif;
    color: black;
    font-size: 20px;
    text-align: center;
}

h4.date{ 
    font-family: 'Lora', serif;
    color: black;
    font-size: 12px;
    text-align: center;
}

p{
  font-family: 'Lora', serif;
  text-align: justify;
  font-size: 16px
}
h2 {
  font-family: 'Lora', serif;
  font-size: 16px;
  text-align: justify;
}


```


```{r include=FALSE}

library("tidyverse")
library("readxl")
library('googlesheets4')
library("janitor")
library ("abjData")
library("geobr")
library("dplyr")
library("tidyr")
library("purrr")
library("reactable")

```




```{r include=FALSE}

dados_respondentes <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1Zydeu1lZf6rzGeZ3byB_I23TFw9FPqZHn3yYI0LIP_E/edit#gid=0", sheet = 3) %>% 
  janitor::clean_names()


dados_completos <- read_sheet(ss = "https://docs.google.com/spreadsheets/d/1Zydeu1lZf6rzGeZ3byB_I23TFw9FPqZHn3yYI0LIP_E/edit#gid=0", sheet = 2) 


```


**Estatística Descritiva**

**1. Caracterização da Amostra**

Tabela 1 - Porcentagem de participantes por serviço


```{r echo=FALSE, align = 'center'}

tabela_area <- dados_respondentes %>% 
  group_by(area) %>% 
  tally() %>% 
  mutate(area = replace_na(area, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n)


total_n <- sum(tabela_area$n)
total_pct <- 1


linha_total <- tibble(
  area = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_1 <- bind_rows(tabela_area, linha_total) 

row_style <- function(index) {
  if (index == nrow(tabela_completa_1)) {
    list(
      backgroundColor = "#ebf1f2", 
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_1 %>% 
  reactable(
    outlined = TRUE, 
    fullWidth = FALSE,
    bordered = FALSE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
    headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )),
    columns = list(
      area = colDef(name = "Serviço", minWidth = 350, align = "left"), # alinha "area" à esquerda
      n = colDef(name = "Quantidade", minWidth = 150, align = "center"), # alinha "n" no meio
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150, align = "center") # alinha "pct" no meio
    ),
    rowStyle = row_style)
  



```


Tabela 2 - Porcentagem de participantes por profissão



```{r echo=FALSE}

tabela_cargo <- dados_respondentes %>% 
  group_by(cargo) %>% 
  tally() %>% 
  mutate(cargo = replace_na(cargo, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n)


total_n <- sum(tabela_cargo$n)
total_pct <- 1


linha_total <- tibble(
  cargo = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_2 <- bind_rows(tabela_cargo, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_2)) {
    list(
      backgroundColor = "#ebf1f2", 
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_2 %>% 
  reactable(
    outlined = TRUE, 
    fullWidth = FALSE,
    bordered = FALSE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )), 
      columns = list(
      cargo = colDef(name = "Serviço", minWidth = 350, align = "left"),
      n = colDef(name = "Quantidade", minWidth = 150, align = "center"), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150, align = "center")
    ), rowStyle = row_style
  )

```


Tabela 3 - Tempo trabalhado neste hospital



```{r}

tabela_temp_hospital <- dados_respondentes %>% 
  group_by(ha_quanto_tempo_voce_trabalha_neste_hospital) %>% 
  tally() %>% 
  mutate(ha_quanto_tempo_voce_trabalha_neste_hospital = replace_na(ha_quanto_tempo_voce_trabalha_neste_hospital, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Tempo = ha_quanto_tempo_voce_trabalha_neste_hospital)


total_n <- sum(tabela_temp_hospital$n)
total_pct <- 1


linha_total <- tibble(
  Tempo = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_3 <- bind_rows(tabela_temp_hospital, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_3)) {
    list(
      backgroundColor = "#ebf1f2", 
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_3 %>% 
  reactable(
    outlined = TRUE, 
    fullWidth = FALSE,
    bordered = FALSE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )
    ),
    columns = list(
      Tempo = colDef(name = "Tempo", minWidth = 300, align = "left"),
      n = colDef(name = "Quantidade", minWidth = 150, align = "center"), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150, , align = "center")
    ), rowStyle = row_style
  )


```


Tabela 4 - Tempo trabalhado na área/unidade atual



```{r}

tabela_temp_funcao <- dados_respondentes %>% 
  group_by(neste_hospital_ha_quanto_tempo_voce_trabalha_na_sua_atual_unidade_area_de_trabalho) %>% 
  tally() %>% 
  mutate(neste_hospital_ha_quanto_tempo_voce_trabalha_na_sua_atual_unidade_area_de_trabalho = replace_na(neste_hospital_ha_quanto_tempo_voce_trabalha_na_sua_atual_unidade_area_de_trabalho, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Tempo = neste_hospital_ha_quanto_tempo_voce_trabalha_na_sua_atual_unidade_area_de_trabalho)


total_n <- sum(tabela_temp_funcao$n)
total_pct <- 1


linha_total <- tibble(
  Tempo = "Total",
  n = total_n,
  pct = total_pct
)


tabela_completa_4 <- bind_rows(tabela_temp_funcao, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_4)) {
    list(
      backgroundColor = "#ebf1f2", 
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_4 %>% 
  reactable(
    outlined = TRUE, 
    fullWidth = FALSE,
    bordered = FALSE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )
    ),
    columns = list(
      Tempo = colDef(name = "Tempo", minWidth = 300, align = "left"),
      n = colDef(name = "Quantidade", minWidth = 150, align = "center"), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150,  align = "center")
    ), rowStyle = row_style
  )



```

Tabela 5 - Quantidade de horas trabalhadas por semana


```{r}


tabela_horas_trabalho <- dados_respondentes %>% 
  group_by(	
normalmente_quantas_horas_por_semana_voce_trabalha_neste_hospital) %>% 
  tally() %>% 
  mutate(	
normalmente_quantas_horas_por_semana_voce_trabalha_neste_hospital = replace_na(normalmente_quantas_horas_por_semana_voce_trabalha_neste_hospital, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Tempo = 	
normalmente_quantas_horas_por_semana_voce_trabalha_neste_hospital)


total_n <- sum(tabela_horas_trabalho$n)
total_pct <- 1


linha_total <- tibble(
  Tempo = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_5 <- bind_rows(tabela_horas_trabalho, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_5)) {
    list(
      backgroundColor = "#ebf1f2", 
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_5 %>% 
  reactable(
    outlined = TRUE, 
    fullWidth = FALSE,
    bordered = FALSE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )
    ),
    columns = list(
      Tempo = colDef(name = "Tempo", minWidth = 300, align = "left"),
      n = colDef(name = "Quantidade", minWidth = 150, align = "center"), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150, align = "center")
    ), rowStyle = row_style
  )



```



Tabela 6 - Interação ou contato direto com os pacientes



```{r}


tabela_contato <- dados_respondentes %>% 
  group_by(no_seu_cargo_funcao_em_geral_voce_tem_interacao_ou_contato_direto_com_os_pacientes) %>% 
  tally() %>% 
  mutate(no_seu_cargo_funcao_em_geral_voce_tem_interacao_ou_contato_direto_com_os_pacientes = replace_na(	
no_seu_cargo_funcao_em_geral_voce_tem_interacao_ou_contato_direto_com_os_pacientes, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Contato = 	no_seu_cargo_funcao_em_geral_voce_tem_interacao_ou_contato_direto_com_os_pacientes)


total_n <- sum(tabela_contato$n)
total_pct <- 1


linha_total <- tibble(
  Contato = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_6 <- bind_rows(tabela_contato, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_6)) {
    list(
      backgroundColor = "#ebf1f2", 
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_6 %>% 
  reactable(
    outlined = TRUE, 
    fullWidth = FALSE,
    bordered = FALSE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
     headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )
    ),
    columns = list(
      Contato = colDef(name = "Contato", minWidth = 500, align = "left"),
      n = colDef(name = "Quantidade", minWidth = 150, align = "center"), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150, align = "center")
    ), rowStyle = row_style
  )



```

**2. Cultura de Segurança do Paciente: Indicadores do HSOPSC**


Tabela 8 - Quantidade de eventos adversos notificados


```{r}

tabela_eventos <- dados_respondentes %>% 
  group_by(nos_ultimos_doze_meses_quantos_incidentes_relacionados_a_seguranca_do_paciente_voce_notificou) %>% 
  tally() %>% 
  mutate(nos_ultimos_doze_meses_quantos_incidentes_relacionados_a_seguranca_do_paciente_voce_notificou = replace_na(	
nos_ultimos_doze_meses_quantos_incidentes_relacionados_a_seguranca_do_paciente_voce_notificou, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Eventos = 	nos_ultimos_doze_meses_quantos_incidentes_relacionados_a_seguranca_do_paciente_voce_notificou)


total_n <- sum(tabela_eventos$n)
total_pct <- 1


linha_total <- tibble(
  Eventos = "Total",
  n = total_n,
  pct = total_pct
)


tabela_completa_7 <- bind_rows(tabela_eventos, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_7)) {
    list(
      backgroundColor = "#ebf1f2", 
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_7 %>% 
  reactable(
    outlined = TRUE, 
    fullWidth = FALSE,
    bordered = FALSE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
     headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )
    ),
    columns = list(
      Eventos = colDef(name = "Eventos", minWidth = 200, align = "left"),
      n = colDef(name = "Quantidade", minWidth = 150, align = "center"), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150, align = "center")
    ), rowStyle = row_style
  )


```


Tabela 9 - Percepção da segurança do paciente no ambiente de trabalho

```{r}


tabela_avaliacao <- dados_respondentes %>% 
  group_by(avaliacao) %>% 
  tally() %>% 
  mutate(avaliacao = replace_na(	
avaliacao, "Outros")) %>% 
  mutate(pct = n/sum(n)) %>% 
  arrange(-n) %>% 
  rename(Nota = 	avaliacao)


total_n <- sum(tabela_avaliacao$n)
total_pct <- 1


linha_total <- tibble(
  Nota = "Total",
  n = total_n,
  pct = total_pct
)

tabela_completa_8 <- bind_rows(tabela_avaliacao, linha_total)

row_style <- function(index) {
  if (index == nrow(tabela_completa_8)) {
    list(
      backgroundColor = "#ebf1f2", 
      fontWeight = "bold")
  } else {
    NULL
  }
}

tabela_completa_8  %>% 
  reactable(
    outlined = TRUE, 
    fullWidth = FALSE,
    bordered = FALSE,
    striped = FALSE,
    pagination = FALSE, # Desativa a paginação
    defaultColDef = colDef(
      headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )
    ),
    columns = list(
      Nota = colDef(name = "Nota", minWidth = 200, align = "left"),
      n = colDef(name = "Quantidade", minWidth = 150, align = "center"), 
      pct = colDef(name = "Porcentagem", format = colFormat(percent = TRUE, digits = 1), minWidth = 150, align = "center")
    ), rowStyle = row_style
  )


```


Tabela 10 - Porcentagem de respostas por dimensão


```{r eval=FALSE, include=FALSE}

primeira_dimensao <- dados_completos %>% 
  rename(pergunta_1 = meu_supervisor_gerente_ou_chefe_de_equipe_clinica_considera_seriamente_as_sugestoes_dos_profissionais_para_melhorar_a_seguranca_do_paciente, 
         pergunta_2 =  meu_supervisor_gerente_ou_chefe_de_equipe_clinica_quer_que_trabalhemos_mais_rapido_nos_horarios_de_demanda_intensa_de_trabalho_mesmo_que_isso_implique_em_pular_etapas, 
         pergunta_3 = meu_supervisor_gerente_ou_chefe_de_equipe_clinica_adota_medidas_para_resolver_as_questoes_de_seguranca_do_paciente_que_lhe_sao_apresentadas) %>% 
  select(pergunta_1, pergunta_2,  pergunta_3) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Negativo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Positivo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
  mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Positivo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Negativo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = case_when(value == "Positivo" ~ "1 - Apoio do Supervisor, gestor ou liderança clínica para a segurança do paciente"))
  

```



```{r}


segunda_dimensao <- dados_completos %>% 
  rename(pergunta_1 = nesta_unidade_trabalhamos_juntos_como_uma_equipe_integrada, 
         pergunta_2 =  durante_periodos_de_sobrecarga_de_trabalho_os_profissionais_desta_unidade_ajudam_uns_aos_outros, 
         pergunta_3 = ha_problema_com_comportamento_desrespeitoso_por_parte_daqueles_que_trabalham_nesta_unidade) %>% 
  select(pergunta_1, pergunta_2,  pergunta_3) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Positivo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Negativo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
  mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Negativo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Positivo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "2 - Trabalho em Equipe", value))


```




```{r}


terceira_dimensao <- dados_completos %>% 
  rename(pergunta_1 = nesta_unidade_os_profissionais_se_falam_abertamente_quando_veem_algo_que_pode_afetar_negativamente_o_cuidado_do_paciente, 
         pergunta_2 = quando_os_profissionais_desta_unidade_veem_alguem_com_mais_autoridade_fazendo_algo_inseguro_para_os_pacientes_eles_falam_abertamente, 
         pergunta_3 = quando_os_profissionais_desta_unidade_se_manifestam_as_pessoas_com_mais_autoridade_estao_abertas_as_suas_preocupacoes_em_relacao_a_seguranca_do_paciente) %>% 
  select(pergunta_1, pergunta_2,  pergunta_3) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Positivo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Negativo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
  mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Negativo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Positivo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "3 - Abertura para a Comunicação", value))




```



```{r}

quarta_dimensao <- dados_completos %>% 
  rename(pergunta_1 = quando_um_incidente_e_detectado_e_corrigido_antes_de_atingir_o_paciente_com_que_frequencia_ele_e_notificado, 
         pergunta_2 = quando_um_incidente_atinge_o_paciente_e_poderia_ter_lhe_causado_dano_mas_nao_lhe_causou_com_que_frequencia_ele_e_notificado) %>% 
  select(pergunta_1, pergunta_2) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Positivo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Negativo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = case_when(value == "Positivo" ~ "4 - Notificação de Eventos de Segurança do Paciente"))




```



```{r}

quinta_dimensao <- dados_completos %>% 
  rename(pergunta_1 = esta_unidade_revisa_regularmente_os_processos_de_trabalho_para_determinar_se_sao_necessarias_mudancas_para_melhorar_a, 
         pergunta_2 = nesta_unidade_as_mudancas_para_melhorar_a_seguranca_do_paciente_sao_avaliadas_para_verificar_se_elas_estao_funcionando_bem,
          pergunta_3 = esta_unidade_permite_que_os_mesmos_continuem_ocorrendo_problemas_de_seguranca_do_paciente) %>% 
  select(pergunta_1, pergunta_2, pergunta_3) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Positivo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Negativo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Negativo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Positivo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "5 - Aprendizado Organizacional e Melhoria Contínua", value))




```


```{r}

sexta_dimensao <- dados_completos %>% 
  rename(pergunta_1 = somos_informados_sobre_os_erros_incidentes_de_seguranca_que_acontecem_nesta_unidade, 
         pergunta_2 = quando_acontecem_erros_incidentes_de_seguranca_nessa_unidade_discutimos_maneiras_de_evitar_que_voltem_a_acontecer,
          pergunta_3 = nesta_unidade_somos_informados_sobre_as_mudancas_realizadas_com_base_nos_relatorios_de_notificacao_de_incidentes) %>% 
  select(pergunta_1, pergunta_2, pergunta_3) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Positivo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Negativo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Positivo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Negativo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "6 - Comunicação sobre Erro", value))


```

```{r}

setima_dimensao <- dados_completos %>% 
  rename(pergunta_1 = as_acoes_da_gestao_do_hospital_demonstram_que_a_seguranca_do_paciente_tem_alta_prioridade, 
         pergunta_2 = a_gestao_do_hospital_fornece_recursos_adequados_para_melhorar_a_seguranca_do_paciente,
          pergunta_3 = a_gestao_do_hospital_parece_ter_interesse_na_seguranca_do_paciente_somente_apos_a_ocorrencia_de_um_evento_adverso) %>% 
  select(pergunta_1, pergunta_2, pergunta_3) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Positivo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Negativo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Positivo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Negativo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "7 - Suporte da Administração do Hospital a Segurança do Paciente", value))


```

```{r}

oitava_dimensao <- dados_completos %>% 
  rename(pergunta_1 = quando_os_profissionais_cometem_erros_esta_unidade_se_concentra_no_aprendizado_ao_inves_de_culpar_os_individuos, 
         pergunta_2 = nesta_unidade_os_profissionais_sentem_que_seus_erros_falhas_podem_ser_usados_contra_eles,
          pergunta_3 = quando_um_incidente_e_notificado_nesta_unidade_a_impressao_que_se_tem_e_que_a_pessoa_esta_sendo_notificada_e_nao_o_problema, 
         pergunta_4 = nesta_unidade_falta_apoio_aos_profissionais_envolvidos_em_erros_falhas_que_comprometem_a_seguranca_do_paciente) %>% 
  select(pergunta_1, pergunta_2, pergunta_3, pergunta_4) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Negativo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Positivo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
  mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Negativo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Positivo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  mutate(pergunta_4 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Negativo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Positivo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "8 - Resposta ao Erro", value))


```



```{r}


nona_dimensao <- dados_completos %>% 
  rename(pergunta_1 = durante_as_mudancas_de_turno_plantao_ha_tempo_suficiente_para_trocar_todas_as_informacoes_importantes_para_o_cuidado_do_paciente, 
         pergunta_2 = quando_pacientes_sao_transferidos_de_uma_unidade_para_outra_informacoes_importantes_sobre_o_seu_cuidado_sao_frequentemente_perdidas,
          pergunta_3 = durante_as_mudancas_de_turno_plantao_informacoes_importantes_sobre_o_cuidado_do_paciente_frequentemente_sao_omitidas) %>% 
  select(pergunta_1, pergunta_2, pergunta_3) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Negativo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Positivo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Negativo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Positivo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "9 - Transferências e Trocas de Informação", value))

```


```{r}

decima_dimensao <- dados_completos %>% 
  rename(pergunta_1 = nesta_unidade_temos_profissionais_suficientes_para_lidar_com_a_carga_de_trabalho, 
         pergunta_2 = os_profissionais_desta_unidade_trabalham_mais_horas_do_que_seria_o_desejavel_para_prestar_o_melhor_cuidado_ao_paciente,
          pergunta_3 = esta_unidade_depende_demasiado_de_profissionais_com_contrato_terceirizado_ou_contratado_por_qualquer_outro_regime_temporario, 
         pergunta_4 = o_ritmo_de_trabalho_nesta_unidade_e_tao_intenso_que_afeta_negativamente_a_seguranca_do_paciente) %>% 
  select(pergunta_1, pergunta_2, pergunta_3, pergunta_4) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  mutate(pergunta_2 = case_when(pergunta_2 == 4 | pergunta_2 == 5 ~ "Negativo", 
                                pergunta_2 == 1 | pergunta_2 == 2  ~ "Positivo", 
                                pergunta_2 == 3 ~ "Neutro", 
                                pergunta_2 == 9 ~ "N/a")) %>% 
  mutate(pergunta_3 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Negativo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Positivo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  mutate(pergunta_4 = case_when(pergunta_3 == 4 | pergunta_3 == 5 ~ "Negativo", 
                                pergunta_3 == 1 | pergunta_3 == 2  ~ "Positivo", 
                                pergunta_3 == 3 ~ "Neutro", 
                                pergunta_3 == 9 ~ "N/a")) %>% 
  pivot_longer(cols = starts_with("pergunta"), names_to = "dimensao_1") %>% 
  group_by(value) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)) %>% 
  filter(value == "Positivo") %>% 
  select(1, 3) %>% 
  mutate(value = gsub("Positivo", "10 - Pessoal e Ritmo de Trabalho", value))


```


```{r}

tabela_completa <- bind_rows(
  primeira_dimensao,
  segunda_dimensao, 
  terceira_dimensao, 
  quarta_dimensao, 
  quinta_dimensao, 
  sexta_dimensao, 
  setima_dimensao,
  oitava_dimensao,
  nona_dimensao, 
  decima_dimensao
) 


reactable(
  tabela_completa,
  outlined = TRUE, 
  fullWidth = FALSE,
  bordered = FALSE,
  striped = FALSE,
  pagination = FALSE, # Desativa a paginação
  defaultColDef = colDef(
    headerStyle = list(borderWidth = 3, backgroundColor = "#ebf1f2" )
  ),
  columns = list(
    value = colDef(name = "Dimensão", minWidth = 550, align = "left"),
    pct = colDef(name = "Positivas", format = colFormat(percent = TRUE, digits = 1), minWidth = 150, align = "center", 
                 style = function(value) {
      if (value < 0.30) {
        color <- "#e00000"
      } else if (value > 0.7) {
        color <- "#008000"
      } else {
        color <- "black"
      }
      list(color = color)
    }
  )
))


  
  


```

**3. Cultura de Segurança do Paciente, Itens agrupados por dimensões**

## 1 - Apoio do Supervisor, gestor ou liderança clínica para a segurança do paciente



```{r}


grafico_1 <- dados_completos %>% 
  rename(pergunta_1 = meu_supervisor_gerente_ou_chefe_de_equipe_clinica_considera_seriamente_as_sugestoes_dos_profissionais_para_melhorar_a_seguranca_do_paciente) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  select(pergunta_1) %>% 
  filter(pergunta_1 != "N/a") %>% 
  group_by(pergunta_1) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)*100) %>% 
  mutate(pct = round(pct, 0)) %>% 
  ggplot(aes(x = "", y = pct, fill = pergunta_1)) +
  geom_bar(width = 0.1, stat = "identity") +  # width = 1 para preencher completamente as barras
  coord_flip() +  # Inverte eixo x e y para criar um gráfico de barras horizontais
  scale_fill_manual(values = c("Positivo" = "#68bd58", "Negativo" = "#c21f40", "Neutro" = "#f0a830")) +  # Define as cores para cada categoria
  theme_void() +  # Remove todos os elementos de tema padrão
  labs(x = NULL, y = NULL, fill = NULL) +
  geom_text(aes(label = paste0(pct, "%")), position = position_stack(vjust = 0.5), color = "white", size = 4.5) +# Remove rótulos de eixos e legenda de cores +
  theme(
  legend.position = "none"
)
  
 ggsave("grafico_1.png", plot = grafico_1, width = 8, height = 6, units = "in", dpi = 300) 


```



```{r}


grafico_2 <- dados_completos %>% 
  rename(pergunta_1 = meu_supervisor_gerente_ou_chefe_de_equipe_clinica_quer_que_trabalhemos_mais_rapido_nos_horarios_de_demanda_intensa_de_trabalho_mesmo_que_isso_implique_em_pular_etapas) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Negativo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Positivo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  select(pergunta_1) %>% 
  filter(pergunta_1 != "N/a") %>% 
  group_by(pergunta_1) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)*100) %>% 
  mutate(pct = round(pct, 0)) %>% 
  ggplot(aes(x = "", y = pct, fill = pergunta_1)) +
  geom_bar(width = 0.1, stat = "identity") +  # width = 1 para preencher completamente as barras
  coord_flip() +  # Inverte eixo x e y para criar um gráfico de barras horizontais
  scale_fill_manual(values = c("Positivo" = "#68bd58", "Negativo" = "#c21f40", "Neutro" = "#f0a830")) +  # Define as cores para cada categoria
  theme_void() +  # Remove todos os elementos de tema padrão
  labs(x = NULL, y = NULL, fill = NULL) +
  geom_text(aes(label = paste0(pct, "%")), position = position_stack(vjust = 0.5), color = "white", size = 4.5) +# Remove rótulos de eixos e legenda de cores +
  theme(
  legend.position = "none"
)
  
 ggsave("grafico_2.png", plot = grafico_2, width = 8, height = 6, units = "in", dpi = 300) 


```


```{r}


grafico_3 <- dados_completos %>% 
  rename(pergunta_1 = meu_supervisor_gerente_ou_chefe_de_equipe_clinica_adota_medidas_para_resolver_as_questoes_de_seguranca_do_paciente_que_lhe_sao_apresentadas) %>% 
  mutate(pergunta_1 = case_when(pergunta_1 == 4 | pergunta_1 == 5 ~ "Positivo", 
                                pergunta_1 == 1 | pergunta_1 == 2  ~ "Negativo", 
                                pergunta_1 == 3 ~ "Neutro", 
                                pergunta_1 == 9 ~ "N/a")) %>% 
  select(pergunta_1) %>% 
  filter(pergunta_1 != "N/a") %>% 
  group_by(pergunta_1) %>% 
  tally() %>% 
  mutate(pct = n/sum(n)*100) %>% 
  mutate(pct = round(pct, 0)) %>% 
  ggplot(aes(x = "", y = pct, fill = pergunta_1)) +
  geom_bar(width = 0.1, stat = "identity") +  # width = 1 para preencher completamente as barras
  coord_flip() +  # Inverte eixo x e y para criar um gráfico de barras horizontais
  scale_fill_manual(values = c("Positivo" = "#68bd58", "Negativo" = "#c21f40", "Neutro" = "#f0a830")) +  # Define as cores para cada categoria
  theme_void() +  # Remove todos os elementos de tema padrão
  labs(x = NULL, y = NULL, fill = NULL) +
  geom_text(aes(label = paste0(pct, "%")), position = position_stack(vjust = 0.5), color = "white", size = 4.5) +# Remove rótulos de eixos e legenda de cores +
  theme(
  legend.position = "none"
)
  
 ggsave("grafico_3.png", plot = grafico_3, width = 8, height = 6, units = "in", dpi = 300) 


```






